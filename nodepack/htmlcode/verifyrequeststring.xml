<node>
  <createtime>2009-03-27 11:44:17</createtime>
  <totalvotes>0</totalvotes>
  <node_id>1979760</node_id>
  <code>#Generates a query string used to verify the form submission. Pass a prefix.
my ($prefix) = @_;
use Digest::MD5 qw(md5_hex);
my $rand = rand(999999999);
my $nonce;

if ($$USER{title} eq 'Guest User') {

  $nonce = md5_hex(htmlcode('getStarRatingSessionId') . ' ' . $rand);

} else {

  $nonce = md5_hex($$USER{passwd} . ' ' . $$USER{email} . $rand);

}

return $prefix . '_nonce = ' . $nonce . '&amp;' . $prefix . '_seed = ' . $rand;</code>
  <type_nodetype>4</type_nodetype>
  <title>verifyRequestString</title>
</node>
