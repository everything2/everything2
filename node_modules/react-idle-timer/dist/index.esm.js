var dt=Object.create,Ie=Object.defineProperty;var pt=Object.getOwnPropertyDescriptor;var ft=Object.getOwnPropertyNames;var ht=Object.getPrototypeOf,vt=Object.prototype.hasOwnProperty;var Tt=t=>Ie(t,"__esModule",{value:!0});var It=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Et=(t,e,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of ft(e))!vt.call(t,r)&&r!=="default"&&Ie(t,r,{get:()=>e[r],enumerable:!(n=pt(e,r))||n.enumerable});return t},bt=t=>Et(Tt(Ie(t!=null?dt(ht(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Be=It((se,We)=>{(function(t,e){typeof se=="object"&&typeof We!="undefined"?e(se):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis!="undefined"?globalThis:t||self,e(t.fastUniqueNumbers={}))})(se,function(t){"use strict";var e=function(d){return function(v){var o=d(v);return v.add(o),o}},n=function(d){return function(v,o){return d.set(v,o),o}},r=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,a=536870912,u=a*2,b=function(d,v){return function(o){var M=v.get(o),P=M===void 0?o.size:M<u?M+1:0;if(!o.has(P))return d(o,P);if(o.size<a){for(;o.has(P);)P=Math.floor(Math.random()*u);return d(o,P)}if(o.size>r)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;o.has(P);)P=Math.floor(Math.random()*r);return d(o,P)}},x=new WeakMap,ee=n(x),p=b(ee,x),c=e(p);t.addUniqueNumber=c,t.generateUniqueNumber=p,Object.defineProperty(t,"__esModule",{value:!0})})});import gt,{forwardRef as wt}from"react";function yt(t){return wt(function(n,r){let a={...n};!a.onPrompt&&t.prototype.onPrompt&&(a.onPrompt=()=>{t.prototype.onPrompt()}),!a.onIdle&&t.prototype.onIdle&&(a.onIdle=()=>{t.prototype.onIdle()}),!a.onActive&&t.prototype.onActive&&(a.onActive=x=>{t.prototype.onActive(x)}),!a.onAction&&t.prototype.onAction&&(a.onAction=x=>{t.prototype.onAction(x)});let u=t.prototype.componentDidMount;u&&(t.prototype.componentDidMount=()=>{setTimeout(()=>{u()})});let b=$(a);return typeof r=="function"?r(b):r&&(r.current=b),gt.createElement(t,{...n,...b})})}import{useEffect as V,useRef as h,useCallback as I,useMemo as xt}from"react";var K=bt(Be());var He=t=>t.method!==void 0&&t.method==="call";var Ve=t=>t.error===null&&typeof t.id=="number";var Ge=t=>{let e=new Map([[0,()=>{}]]),n=new Map([[0,()=>{}]]),r=new Map,a=new Worker(t);return a.addEventListener("message",({data:p})=>{if(He(p)){let{params:{timerId:c,timerType:m}}=p;if(m==="interval"){let d=e.get(c);if(typeof d=="number"){let v=r.get(d);if(v===void 0||v.timerId!==c||v.timerType!==m)throw new Error("The timer is in an undefined state.")}else if(typeof d!="undefined")d();else throw new Error("The timer is in an undefined state.")}else if(m==="timeout"){let d=n.get(c);if(typeof d=="number"){let v=r.get(d);if(v===void 0||v.timerId!==c||v.timerType!==m)throw new Error("The timer is in an undefined state.")}else if(typeof d!="undefined")d(),n.delete(c);else throw new Error("The timer is in an undefined state.")}}else if(Ve(p)){let{id:c}=p,m=r.get(c);if(m===void 0)throw new Error("The timer is in an undefined state.");let{timerId:d,timerType:v}=m;r.delete(c),v==="interval"?e.delete(d):n.delete(d)}else{let{error:{message:c}}=p;throw new Error(c)}}),{clearInterval:p=>{let c=(0,K.generateUniqueNumber)(r);r.set(c,{timerId:p,timerType:"interval"}),e.set(p,c),a.postMessage({id:c,method:"clear",params:{timerId:p,timerType:"interval"}})},clearTimeout:p=>{let c=(0,K.generateUniqueNumber)(r);r.set(c,{timerId:p,timerType:"timeout"}),n.set(p,c),a.postMessage({id:c,method:"clear",params:{timerId:p,timerType:"timeout"}})},setInterval:(p,c)=>{let m=(0,K.generateUniqueNumber)(e);return e.set(m,()=>{p(),typeof e.get(m)=="function"&&a.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:m,timerType:"interval"}})}),a.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:m,timerType:"interval"}}),m},setTimeout:(p,c)=>{let m=(0,K.generateUniqueNumber)(n);return n.set(m,p),a.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:m,timerType:"timeout"}}),m}}};var Q=null,qe=(t,e)=>()=>{if(Q!==null)return Q;let n=new Blob([e],{type:"application/javascript; charset=utf-8"}),r=URL.createObjectURL(n);return Q=t(r),Q.setTimeout(()=>URL.revokeObjectURL(r),0),Q};var je=`(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error('The given type "'.concat(i,'" is not supported'));(e=>{const r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error('The given method "'.concat(s.method,'" is not supported'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error('The given type "'.concat(d,'" is not supported'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();`;var ae=qe(Ge,je),Ye=t=>ae().clearInterval(t),Je=t=>ae().clearTimeout(t),ze=(t,e)=>ae().setInterval(t,e),Xe=(t,e)=>ae().setTimeout(t,e);var w=(typeof window=="undefined"?"undefined":typeof window)=="object";var T={setTimeout:w?setTimeout.bind(window):setTimeout,clearTimeout:w?clearTimeout.bind(window):clearTimeout,setInterval:w?setInterval.bind(window):setInterval,clearInterval:w?clearInterval.bind(window):clearInterval},Z={setTimeout:Xe,clearTimeout:Je,setInterval:ze,clearInterval:Ye};function Lt(){T.setTimeout=setTimeout,T.clearTimeout=clearTimeout,T.setInterval=setInterval,T.clearInterval=clearInterval,Z.setTimeout=setTimeout,Z.clearTimeout=clearTimeout,Z.setInterval=setInterval,Z.clearInterval=clearInterval}function $e(t){T.setTimeout=t.setTimeout,T.clearTimeout=t.clearTimeout,T.setInterval=t.setInterval,T.clearInterval=t.clearInterval}var Y={},Ke=class{constructor(e){this.closed=!1;this.mc=new MessageChannel;this.name=e,Y[e]=Y[e]||[],Y[e].push(this),this.mc.port1.start(),this.mc.port2.start(),this.onStorage=this.onStorage.bind(this),window.addEventListener("storage",this.onStorage)}onStorage(e){if(e.storageArea!==window.localStorage||e.key.substring(0,this.name.length)!==this.name||e.newValue===null)return;let n=JSON.parse(e.newValue);this.mc.port2.postMessage(n)}postMessage(e){if(this.closed)throw new Error("InvalidStateError");let n=JSON.stringify(e),r=`${this.name}:${String(Date.now())}${String(Math.random())}`;window.localStorage.setItem(r,n),T.setTimeout(()=>{window.localStorage.removeItem(r)},500),Y[this.name].forEach(a=>{a!==this&&a.mc.port2.postMessage(JSON.parse(n))})}close(){if(this.closed)return;this.closed=!0,this.mc.port1.close(),this.mc.port2.close(),window.removeEventListener("storage",this.onStorage);let e=Y[this.name].indexOf(this);Y[this.name].splice(e,1)}get onmessage(){return this.mc.port1.onmessage}set onmessage(e){this.mc.port1.onmessage=e}get onmessageerror(){return this.mc.port1.onmessageerror}set onmessageerror(e){this.mc.port1.onmessageerror=e}addEventListener(e,n){return this.mc.port1.addEventListener(e,n)}removeEventListener(e,n){return this.mc.port1.removeEventListener(e,n)}dispatchEvent(e){return this.mc.port1.dispatchEvent(e)}},Qe=typeof window=="undefined"?void 0:typeof window.BroadcastChannel=="function"?window.BroadcastChannel:Ke;function Ze(t=0){return new Promise(e=>T.setTimeout(e,t))}function le(){return Math.random().toString(36).substring(2)}var l;(function(o){o[o.APPLY=0]="APPLY",o[o.TELL=1]="TELL",o[o.CLOSE=2]="CLOSE",o[o.REGISTER=3]="REGISTER",o[o.DEREGISTER=4]="DEREGISTER",o[o.IDLE=5]="IDLE",o[o.ACTIVE=6]="ACTIVE",o[o.PROMPT=7]="PROMPT",o[o.START=8]="START",o[o.RESET=9]="RESET",o[o.ACTIVATE=10]="ACTIVATE",o[o.PAUSE=11]="PAUSE",o[o.RESUME=12]="RESUME",o[o.MESSAGE=13]="MESSAGE"})(l||(l={}));var Ee=class{constructor(e,n){this.token=le();this.isLeader=!1;this.isDead=!1;this.isApplying=!1;this.reApply=!1;this.intervals=[];this.listeners=[];this.channel=e,this.options=n,this.apply=this.apply.bind(this),this.awaitLeadership=this.awaitLeadership.bind(this),this.sendAction=this.sendAction.bind(this)}async apply(){if(this.isLeader||this.isDead)return!1;if(this.isApplying)return this.reApply=!0,!1;this.isApplying=!0;let e=!1,n=r=>{let{token:a,action:u}=r.data;a!==this.token&&(u===l.APPLY&&a>this.token&&(e=!0),u===l.TELL&&(e=!0))};this.channel.addEventListener("message",n);try{return this.sendAction(l.APPLY),await Ze(this.options.responseTime),this.channel.removeEventListener("message",n),this.isApplying=!1,e?this.reApply?this.apply():!1:(this.assumeLead(),!0)}catch{return!1}}awaitLeadership(){if(this.isLeader)return Promise.resolve();let e=!1,n=null;return new Promise(r=>{let a=()=>{if(e)return;e=!0,T.clearInterval(n);let b=this.intervals.indexOf(n);this.intervals.splice(b,1),this.channel.removeEventListener("message",u),r()};n=T.setInterval(()=>{this.apply().then(()=>{this.isLeader&&a()})},this.options.fallbackInterval),this.intervals.push(n);let u=b=>{let{action:x}=b.data;x===l.CLOSE&&this.apply().then(()=>{this.isLeader&&a()})};this.channel.addEventListener("message",u)})}sendAction(e){this.channel.postMessage({action:e,token:this.token})}assumeLead(){this.isLeader=!0;let e=n=>{let{action:r}=n.data;r===l.APPLY&&this.sendAction(l.TELL)};return this.channel.addEventListener("message",e),this.listeners.push(e),this.sendAction(l.TELL)}waitForLeadership(){return this.deferred?this.deferred:(this.deferred=this.awaitLeadership(),this.deferred)}close(){this.isDead||(this.isDead=!0,this.isLeader=!1,this.sendAction(l.CLOSE),this.listeners.forEach(e=>this.channel.removeEventListener("message",e)),this.intervals.forEach(e=>T.clearInterval(e)))}};var k;(function(r){r[r.PROMPTED=0]="PROMPTED",r[r.ACTIVE=1]="ACTIVE",r[r.IDLE=2]="IDLE"})(k||(k={}));var be=class{constructor(e){this.token=le();this.registry=new Map;this.allIdle=!1;let{channelName:n}=e;if(this.options=e,this.channel=new Qe(n),this.registry.set(this.token,1),e.leaderElection){let r={fallbackInterval:2e3,responseTime:100};this.elector=new Ee(this.channel,r),this.elector.waitForLeadership()}this.channel.addEventListener("message",r=>{let{action:a,token:u,data:b}=r.data;switch(a){case l.REGISTER:this.registry.set(u,2);break;case l.DEREGISTER:this.registry.delete(u);break;case l.IDLE:this.idle(u);break;case l.ACTIVE:this.active(u);break;case l.PROMPT:this.prompt(u);break;case l.START:this.start(u);break;case l.RESET:this.reset(u);break;case l.ACTIVATE:this.activate(u);break;case l.PAUSE:this.pause(u);break;case l.RESUME:this.resume(u);break;case l.MESSAGE:this.options.onMessage(b);break}}),this.send(l.REGISTER)}get isLeader(){if(!this.elector)throw new Error('\u274C Leader election is not enabled. To Enable it set the "leaderElection" property to true.');return this.elector.isLeader}prompt(e=this.token){this.registry.set(e,0);let n=[...this.registry.values()].every(r=>r===0);e===this.token&&this.send(l.PROMPT),n&&this.options.onPrompt()}idle(e=this.token){this.registry.set(e,2);let n=[...this.registry.values()].every(r=>r===2);e===this.token&&this.send(l.IDLE),!this.allIdle&&n&&(this.allIdle=!0,this.options.onIdle())}active(e=this.token){this.allIdle=!1,this.registry.set(e,1);let n=[...this.registry.values()].some(r=>r===1);e===this.token&&this.send(l.ACTIVE),n&&this.options.onActive()}start(e=this.token){this.allIdle=!1,this.registry.set(e,1),e===this.token?this.send(l.START):this.options.start(!0)}reset(e=this.token){this.allIdle=!1,this.registry.set(e,1),e===this.token?this.send(l.RESET):this.options.reset(!0)}activate(e=this.token){this.allIdle=!1,this.registry.set(e,1),e===this.token?this.send(l.ACTIVATE):this.options.activate(!0)}pause(e=this.token){e===this.token?this.send(l.PAUSE):this.options.pause(!0)}resume(e=this.token){e===this.token?this.send(l.RESUME):this.options.resume(!0)}message(e){try{this.channel.postMessage({action:l.MESSAGE,token:this.token,data:e})}catch{}}send(e){try{this.channel.postMessage({action:e,token:this.token})}catch{}}close(){this.options.leaderElection&&this.elector.close(),this.send(l.DEREGISTER),this.channel.close()}};var et=w?document:null,ge=["mousemove","keydown","wheel","DOMMouseScroll","mousewheel","mousedown","touchstart","touchmove","MSPointerDown","MSPointerMove","visibilitychange"];import{useRef as kt,useEffect as Mt}from"react";function C(t){let e=kt(t);return Mt(()=>{e.current=t},[t]),e}function tt(t,e){let n;function r(...a){n&&clearTimeout(n),n=setTimeout(()=>{t(...a),n=null},e)}return r.cancel=function(){clearTimeout(n)},r}function ue(t,e){let n=0;return function(...r){let a=new Date().getTime();if(!(a-n<e))return n=a,t(...r)}}var E=()=>w?performance.now():Date.now();function $({timeout:t=1e3*60*20,promptTimeout:e=0,element:n=et,events:r=ge,timers:a=void 0,immediateEvents:u=[],onPrompt:b=()=>{},onIdle:x=()=>{},onActive:ee=()=>{},onAction:p=()=>{},onMessage:c=()=>{},debounce:m=0,throttle:d=0,eventsThrottle:v=200,startOnMount:o=!0,startManually:M=!1,stopOnIdle:P=!1,crossTab:G=!1,name:we="idle-timer",syncTimers:J=0,leaderElection:ye=!1}={}){let q=h(E()),Le=h(Date.now()),te=h(E()),N=h(null),_=h(null),ke=h(null),z=h(0),f=h(!0),S=h(!1),U=h(!0),X=h(!1),g=h(!1),y=h(0),O=h(0),D=h(null),s=h(null),R=C(t),re=C(e),rt=C(P),Me=h(u),me=h(n),de=h([...new Set([...r,...u]).values()]),xe=C(x),pe=C(ee),Pe=C(b),ne=C(c),Ae=C(p),W=xt(()=>{let i=L=>Ae.current(L);return m>0?tt(i,m):d>0?ue(i,d):i},[d,m]),Se=h();V(()=>{G&&J&&(Se.current=ue(()=>{s.current.active()},J))},[G,J]);let A=()=>{D.current!==null&&(T.clearTimeout(D.current),D.current=null)},B=(i,L=!0)=>{A(),D.current=T.setTimeout(oe,i||R.current),L&&(_.current=E()),ke.current=Date.now()},Re=i=>{y.current=0,O.current=E(),g.current=!0,B(re.current,!1),Pe.current(i)},Oe=()=>{A(),f.current=!0,N.current=E(),rt.current?H():g.current&&(O.current=0,g.current=!1),xe.current()},fe=i=>{A(),g.current=!1,O.current=0,f.current=!1,z.current+=E()-N.current,F(),B(),pe.current(i)},oe=i=>{if(!f.current){if(W.cancel&&W.cancel(),re.current>0&&!g.current){s.current?s.current.prompt():Re(i);return}s.current?s.current.idle():Oe();return}s.current?s.current.active():fe(i)},De=i=>{if(W(i),g.current)return;if(A(),!f.current&&Me.current.includes(i.type)){oe(i);return}if(!f.current&&Date.now()-ke.current>=R.current){oe(i);return}let L=E()-_.current;if(f.current&&!P||!f.current&&L>=R.current){oe(i);return}S.current=!1,y.current=0,O.current=0,B(),G&&J&&Se.current()},ie=h();V(()=>{let i=X.current;i&&H(),v>0?ie.current=ue(De,v):ie.current=De,i&&F()},[v,d,m,Ae,G,J]);let F=()=>{!w||X.current||(de.current.forEach(i=>{me.current.addEventListener(i,ie.current,{capture:!0,passive:!0})}),X.current=!0)},H=(i=!1)=>{!w||(X.current||i)&&(de.current.forEach(L=>{me.current.removeEventListener(L,ie.current,{capture:!0})}),X.current=!1)},j=I(i=>{A(),F(),f.current=!1,g.current=!1,S.current=!1,y.current=0,O.current=0,s.current&&!i&&s.current.start(),B()},[D,f,R,s]),he=I(i=>{A(),F(),f.current=!1,g.current=!1,S.current=!1,y.current=0,O.current=0,q.current=E(),te.current=E(),s.current&&!i&&s.current.reset(),M||B()},[D,f,R,M,s]),Ce=I(i=>{A(),F(),(f.current||g.current)&&fe(),f.current=!1,g.current=!1,S.current=!1,y.current=0,O.current=0,te.current=E(),s.current&&!i&&s.current.activate(),B()},[D,f,R,s]),ve=I((i=!1)=>S.current?!1:(y.current=Ne(),S.current=!0,H(),A(),s.current&&!i&&s.current.pause(),!0),[D,s]),Te=I((i=!1)=>S.current?(S.current=!1,g.current||F(),f.current||B(y.current),O.current&&(O.current=E()),s.current&&!i&&s.current.resume(),!0):!1,[D,R,y,s]),nt=I((i,L)=>{s.current?(L&&ne.current(i),s.current.message(i)):L&&ne.current(i)},[c]),ot=I(()=>f.current,[f]),it=I(()=>g.current,[g]),st=I(()=>{if(!s.current)throw new Error('\u274C Cross Tab feature is not enabled. To enable it set the "crossTab" property to true.');return s.current.isLeader},[s]),at=I(()=>{if(!s.current)throw new Error('\u274C Cross Tab feature is not enabled. To enable it set the "crossTab" property to true.');return s.current.token},[s]),Ne=I(()=>{if(S.current)return y.current;let i=y.current?y.current:re.current+R.current,L=_.current?E()-_.current:0,Ue=Math.floor(i-L);return Ue<0?0:Math.abs(Ue)},[R,re,g,y,_]),lt=I(()=>Math.round(E()-te.current),[te]),_e=I(()=>Math.round(E()-q.current),[q]),ut=I(()=>N.current?new Date(Le.current-q.current+N.current):null,[N]),ct=I(()=>_.current?new Date(Le.current-q.current+_.current):null,[_]),Fe=I(()=>f.current?Math.round(E()-N.current+z.current):Math.round(z.current),[N,z]),mt=I(()=>{let i=Math.round(_e()-Fe());return i>=0?i:0},[q,N,z]);return V(()=>{if(m>0&&d>0)throw new Error("\u274C onAction can either be throttled or debounced, not both.");a&&$e(a);let i=()=>{s.current&&s.current.close(),W.cancel&&W.cancel(),A(),H(!0)};return w&&window.addEventListener("beforeunload",i),()=>{w&&window.removeEventListener("beforeunload",i),s.current&&s.current.close(),W.cancel&&W.cancel(),A(),H(!0)}},[]),V(()=>{s.current&&s.current.close(),G?s.current=new be({channelName:we,leaderElection:ye,onPrompt:()=>{Re()},onIdle:()=>{Oe()},onActive:()=>{fe()},onMessage:ne.current,start:j,reset:he,activate:Ce,pause:ve,resume:Te}):s.current=null},[G,we,ye,Pe,xe,pe,ne,j,he,ve,Te]),V(()=>{A(),H(!0),U.current||(S.current=!0,f.current=!0,y.current=0),!M&&(o?j():F())},[M,o,U]),V(()=>{if(!U.current){let i=[...new Set([...r,...u]).values()];if(H(),de.current=i,me.current=n,Me.current=u,M)return;o?j():F()}},[n,JSON.stringify(r),JSON.stringify(u),U,M,o]),V(()=>{if(U.current)U.current=!1;else{if(R.current=t,M)return;f.current&&(pe.current(),s.current&&s.current.active()),j()}},[t,s,M,U,f]),{message:nt,start:j,reset:he,activate:Ce,pause:ve,resume:Te,isIdle:ot,isPrompted:it,isLeader:st,getTabId:at,getRemainingTime:Ne,getElapsedTime:lt,getTotalElapsedTime:_e,getLastIdleTime:ut,getLastActiveTime:ct,getTotalIdleTime:Fe,getTotalActiveTime:mt}}import Pt,{createContext as At,useContext as St}from"react";var ce=At(null);function Rt(t){let e=$(t);return Pt.createElement(ce.Provider,{value:e},t.children)}var Ot=ce.Consumer;function Dt(){return St(ce)}export{ge as DEFAULT_EVENTS,Ot as IdleTimerConsumer,ce as IdleTimerContext,Rt as IdleTimerProvider,Lt as createMocks,$ as useIdleTimer,Dt as useIdleTimerContext,yt as withIdleTimer,Z as workerTimers};
